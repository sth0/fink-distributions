Package: lynx
Version: 2.8.9rel.1
Revision: 1
Replaces: lynx-ssl (<< 2.8.5-6)

BuildDepends: <<
	bzip2-dev,
	fink-package-precedence,
	gettext-bin,
	gettext-tools,
	libgettext8-dev,
	libiconv-dev,
	libidn,
	libncurses5,
	openssl110-dev
<<
Depends: <<
	bzip2,
	bzip2-shlibs,
	gzip,
	libgettext8-shlibs,
	libiconv,
	libidn-shlibs,
	libncurses5-shlibs,
	ncurses,
	openssl110-shlibs,
	tar,
	unzip
<<
BuildConflicts: coreutils-default

CustomMirror: << 
  Primary: ftp://ftp.invisible-island.net/lynx/tarballs/
  Primary: https://invisible-mirror.net/archives/lynx/tarballs/
<<
Source: mirror:custom:%n%v.tar.bz2
Source-MD5: 44316f1b8a857b59099927edc26bef79
Description: Console based web browser

DescDetail: <<
    Lynx is a web browser that runs inside a terminal emulator,
    e.g. Terminal.app or an xterm. It can't display graphics and also has
    trouble with tables, but it can come in handy in some situations.
<<

##Compile phase
ConfigureParams: <<
 --sysconfdir=%p/etc \
 --libdir=%p/lib \
 --mandir=%p/share/man \
 --enable-nls \
 --disable-full-paths \
 --enable-file-upload \
 --enable-internal-links \
 --with-screen=ncurses \
 --with-ssl \
 --enable-ipv6 \
 --enable-local-docs \
 --enable-persistent-cookies \
 --with-bzlib \
 --with-zlib
<<
SetLIBS: -lncurses
SetCFLAGS: -MD
UseMaxBuildJobs: false
CompileScript: <<
	ZIP=/usr/bin/zip ./configure %c
	make
	fink-package-precedence --depfile-ext='\.d' .
<<

#Install Phase
InstallScript: <<
 make install-full DESTDIR=%d docdir=%p/share/doc/%n helpdir=%p/share/lynx_help
<<
DocFiles: CHANGES COPYHEADER COPYING README
ConfFiles: %p/etc/lynx.cfg
#

DescPort: <<
Unicode characters do not work correctly with Terminal.app but they
display OK in xterm
<<
DescPackaging: <<
The Makefile for the message catalogs doesn't respect DESTDIR, we work
around that by setting the installation paths on the command line.

Putting lynx.cfg in etc/ and the documentation elsewhere is a problem
because the configure script uses libdir for both. Fortunately, only
the path to lynx.cfg is hardcoded into the executable. So we set
libdir to etc/ and override the doc and help directories in the
install step. The Makefile edits lynx.cfg on the fly in the install
step, so all paths are correct.

Previous maintainer Alexander Strange (through 2.8.4-24).
					elcepi (through 2.8.7-2).

Hard-codes executable paths as detected by ./configure. May as well use fink's
commands that are from Essential packages...
	gzip: gzip, gunzip, unzip
	bzip2: bzip2
	tar: tar
but then force others to be from OS X (avoid detection of coreutils and/or 
hard-code /usr/bin pathnames). gettext-tools is close enough to essential (or
at least "always installed") no harm in Depends on it.
<<

License: GPL/OpenSSL
Homepage: https://lynx.invisible-island.net
Maintainer: None <fink-devel@lists.sourceforge.net>
